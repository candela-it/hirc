{% extends "base.html"%}

{% block content %}
<div class="ui vertically divided grid">
    <div class="two column row">
        <div class="column">
            <h2>{{ request.title }}</h2>
            <div class="ui segment">
                <p>{{ request.description }}</p>
            </div>
            <p style="font-size: 12px;">created by: <strong>{{ request.created_by }}</strong> <br>
            request status: <strong>{{ request.status }}</strong> <br>
            question set: <strong>{{ request.question_set }}</strong>

            {% if request.request_leader %}
                <br> request leader: {{ request.request_leader }}
            {% endif %}
            </p>
        </div>
        <div class="column">
            <div id="map" style="height: 500px;"></div>
            <a href="{% url 'download_request' request.id %}">
            <div id="download-button" class="small ui secondary button">
              <i class="download icon"></i> Download
            </div></a>
        </div>
    </div>
    <div class="one column row">
        <div class="column">
            {% include "request_qa.html" %}
        </div>
    </div>
    <div class="one column row">
        <div class="column">
            {% include "request_comments.html" %}
        </div>
    </div>
</div>
{% endblock content %}

{% block extra_js %}
    <script type="text/javascript">
        var map = L.map('map').setView([51.505, -0.09], 2);
        var osmUrl = 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
        var osmAttrib = 'Map data Â© <a href="http://openstreetmap.org">OpenStreetMap</a> contributors';
        var osmTiles = L.tileLayer(osmUrl, {attribution: osmAttrib});

        map.addLayer(osmTiles);

        var geojsonPolygon = jQuery.parseJSON('{{ object.area_of_interest.geojson|safe }}');

        L.geoJson(geojsonPolygon).addTo(map);
    </script>
{% endblock %}